// const data = [{
//         "name": "스타벅스 보라매공원R점",
//         "address": "서울 동작구 보라매로5길 35"
//     },
//     {
//         "name": "스타벅스 관악서울대입구R점",
//         "address": "서울 관악구 관악로 158 BS타워 1층"
//     },
//     {
//         "name": "스타벅스 사당R점",
//         "address": "서울 관악구 남부순환로 2082-25 1 2층"
//     },
//     {
//         "name": "스타벅스 여의도역R점",
//         "address": "서울 영등포구 의사당대로 83 한국휴렛팩커드빌딩 1층"
//     },
//     {
//         "name": "스타벅스 타임스퀘어R점",
//         "address": "서울 영등포구 영중로 15"
//     },
//     {
//         "name": "스타벅스 파미에파크R점",
//         "address": "서울 서초구 사평대로 205 센트럴시티 파미에파크돔"
//     },
//     {
//         "name": "스타벅스 여의도KBS R점",
//         "address": "서울 영등포구 의사당대로 26"
//     },
//     {
//         "name": "스타벅스 용산역써밋R점",
//         "address": "서울 용산구 한강대로 69"
//     },
//     {
//         "name": "스타벅스 여의도공원R점",
//         "address": "서울 영등포구 여의공원로 101"
//     },
//     {
//         "name": "스타벅스 안양역R점",
//         "address": "경기 안양시 만안구 만안로 244 안양민자역사 1층 001호"
//     },
//     {
//         "name": "스타벅스 여의도IFC몰(L1)R점",
//         "address": "서울 영등포구 국제금융로 10"
//     },
//     {
//         "name": "스타벅스 합정폴리스R점",
//         "address": "서울 마포구 양화로 45"
//     },
//     {
//         "name": "스타벅스 강남R점",
//         "address": "서울 강남구 강남대로 390"
//     },
//     {
//         "name": "스타벅스 홍대입구역사거리R점",
//         "address": "서울 마포구 양화로 125"
//     },
//     {
//         "name": "스타벅스 이대R점",
//         "address": "서울 서대문구 이화여대길 34"
//     },
//     {
//         "name": "스타벅스 강남대로논현R점",
//         "address": "서울 서초구 강남대로85길 5"
//     },
//     {
//         "name": "스타벅스 한남동R",
//         "address": "서울 용산구 독서당로 94"
//     },
//     {
//         "name": "스타벅스 강남교보타워R점",
//         "address": "서울 서초구 강남대로 465 1층"
//     },
//     {
//         "name": "스타벅스 한강진역R점",
//         "address": "서울 용산구 이태원로 252"
//     },
//     {
//         "name": "스타벅스 양재강남빌딩R점",
//         "address": "서울 강남구 남부순환로 2621"
//     },
//     {
//         "name": "스타벅스 광화문R점",
//         "address": "서울 종로구 세종대로 167 현대해상본사사옥 별관내"
//     },
//     {
//         "name": "스타벅스 청담스타R점",
//         "address": "서울 강남구 도산대로57길 24"
//     },
//     {
//         "name": "스타벅스 더종로R점",
//         "address": "서울 종로구 종로 51"
//     },
//     {
//         "name": "스타벅스 압구정R점",
//         "address": "서울 강남구 언주로 861"
//     },
//     {
//         "name": "스타벅스 마곡사이언스타워R점",
//         "address": "서울 강서구 마곡동로 62"
//     },
//     {
//         "name": "스타벅스 선릉동신빌딩R점",
//         "address": "서울 강남구 테헤란로 409"
//     },
//     {
//         "name": "스타벅스 대한상공회의소R점",
//         "address": "서울 중구 세종대로 39"
//     },
//     {
//         "name": "스타벅스 스탈릿대치R점",
//         "address": "서울 강남구 남부순환로 2947 대원빌딩"
//     },
//     {
//         "name": "스타벅스 수서역R점",
//         "address": "서울 강남구 광평로 281"
//     },
//     {
//         "name": "스타벅스 SSG마켓도곡R점",
//         "address": "서울 강남구 언주로30길 57 타워팰리스 F동 지하1층"
//     },
//     {
//         "name": "스타벅스 정부서울청사R점",
//         "address": "서울 종로구 새문안로5가길 28"
//     },
//     {
//         "name": "스타벅스 스타필드코엑스몰 R점",
//         "address": "서울 강남구 봉은사로 524"
//     },
//     {
//         "name": "스타벅스 문정법원로R",
//         "address": "서울 송파구 송파대로 201"
//     },
//     {
//         "name": "스타벅스 을지로내외빌딩R점",
//         "address": "서울 중구 을지로 51"
//     },
//     {
//         "name": "스타벅스 잠실대교남단R점",
//         "address": "서울 송파구 송파대로 570 타워730 1층"
//     },
//     {
//         "name": "스타벅스 삼성역섬유센터R점",
//         "address": "서울 강남구 테헤란로 518"
//     },
//     {
//         "name": "스타벅스 판교아비뉴프랑R",
//         "address": "경기 성남시 분당구 동판교로177번길 25"
//     },
//     {
//         "name": "스타벅스 백석R점",
//         "address": "경기 고양시 일산동구 중앙로 1059 1층"
//     },
//     {
//         "name": "스타벅스 광교엘포트R점",
//         "address": "경기 수원시 영통구 광교중앙로 145"
//     },
//     {
//         "name": "스타벅스 용인죽전역R점",
//         "address": "경기 용인시 수지구 용구대로 2750"
//     },
//     {
//         "name": "스타벅스 송도트리플R점",
//         "address": "인천 연수구 송도과학로16번길 33-1"
//     },
//     {
//         "name": "스타벅스 일산가로수길R점",
//         "address": "경기 고양시 일산서구 주엽로 80 E동 107호"
//     },
//     {
//         "name": "스타벅스 영통R점",
//         "address": "경기 수원시 영통구 덕영대로 1566"
//     },
//     {
//         "name": "스타벅스 스타필드고양1F R점",
//         "address": "경기 고양시 덕양구 고양대로 1955"
//     },
//     {
//         "name": "스타벅스 동탄카림R점",
//         "address": "경기 화성시 동탄대로시범길 134"
//     },
//     {
//         "name": "스타벅스 기흥역AK R점",
//         "address": "경기 용인시 기흥구 구갈동 227-26 기흥역 힐스테이트"
//     },
//     {
//         "name": "스타벅스 용인에버랜드R점",
//         "address": "경기 용인시 처인구 포곡읍 에버랜드로 199"
//     },
//     {
//         "name": "스타벅스 천안신부R점",
//         "address": "충남 천안시 동남구 만남로 43 신세계충청점 본관3동 2층"
//     },
//     {
//         "name": "스타벅스 스타필드안성R",
//         "address": "경기 안성시 공도읍 서동대로 3930-39 1층"
//     },
//     {
//         "name": "스타벅스 춘천구봉산R",
//         "address": "강원 춘천시 동면 순환대로 1154-63"
//     },
//     {
//         "name": "스타벅스 세종어진R점",
//         "address": "세종특별자치시 한누리대로 499"
//     },
//     {
//         "name": "스타벅스 대전중앙로R점",
//         "address": "대전 중구 대종로 486"
//     },
//     {
//         "name": "스타벅스 대구수성호수R점",
//         "address": "대구 수성구 용학로 56"
//     },
//     {
//         "name": "스타벅스 대구그랜드호텔R점",
//         "address": "대구 수성구 동대구로 305"
//     },
//     {
//         "name": "스타벅스 신세계대구8F R점",
//         "address": "대구 동구 동부로 149 신세계백화점 대구점 8층"
//     },
//     {
//         "name": "스타벅스 창원상남동R점",
//         "address": "경남 창원시 성산구 상남로 132"
//     },
//     {
//         "name": "스타벅스 서면로R점",
//         "address": "부산 부산진구 서면로 49-1"
//     },
//     {
//         "name": "스타벅스 더해운대R점",
//         "address": "부산 해운대구 해운대해변로 197 해운대경동제이드아파트 101동"
//     },
//     {
//         "name": "스타벅스 서면중앙대로R점",
//         "address": "부산 부산진구 중앙대로 672"
//     },
//     {
//         "name": "스타벅스 부산덕천역R점",
//         "address": "부산 북구 만덕대로 30"
//     },
//     {
//         "name": "스타벅스 부산광복로R점",
//         "address": "부산 중구 광복중앙로 8-2"
//     },
//     {
//         "name": "스타벅스 신세계김해R점",
//         "address": "경남 김해시 김해대로 2232 신세계백화점 1층"
//     },
//     {
//         "name": "스타벅스 제주신화월드R점",
//         "address": "제주특별자치도 서귀포시 안덕면 신화역사로304번길 38 지하1층 29호"
//     }
// ]

const data = [{
    name: "스타벅스 보라매공원R점",
    address: "서울 동작구 보라매로5길 35",
    lat: "37.4920901355933",
    lng: "126.923508147169"
}, {
    name: "스타벅스 관악서울대입구R점",
    address: "서울 관악구 관악로 158 BS타워 1층",
    lat: "37.4793104352293",
    lng: "126.952808280216"
}, {
    name: "스타벅스 사당R점",
    address: "서울 관악구 남부순환로 2082-25 1 2층",
    lat: "37.4760566794321",
    lng: "126.981012772295"
}, {
    name: "스타벅스 여의도역R점",
    address: "서울 영등포구 의사당대로 83 한국휴렛팩커드빌딩 1층",
    lat: "37.5233667660094",
    lng: "126.923451000009"
}, {
    name: "스타벅스 타임스퀘어R점",
    address: "서울 영등포구 영중로 15",
    lat: "37.5172332566615",
    lng: "126.903715993779"
}, {
    name: "스타벅스 파미에파크R점",
    address: "서울 서초구 사평대로 205 센트럴시티 파미에파크돔",
    lat: "37.5044921229104",
    lng: "127.007845270854"
}, {
    name: "스타벅스 여의도KBS R점",
    address: "서울 영등포구 의사당대로 26",
    lat: "37.526537141271",
    lng: "126.918106683928"
}, {
    name: "스타벅스 용산역써밋R점",
    address: "서울 용산구 한강대로 69",
    lat: "37.5270404595814",
    lng: "126.964892234354"
}, {
    name: "스타벅스 여의도공원R점",
    address: "서울 영등포구 여의공원로 101",
    lat: "37.5292719570904",
    lng: "126.924892738645"
}, {
    name: "스타벅스 안양역R점",
    address: "경기 안양시 만안구 만안로 244 안양민자역사 1층 001호",
    lat: "37.4024636617875",
    lng: "126.92212645678"
}, {
    name: "스타벅스 여의도IFC몰(L1)R점",
    address: "서울 영등포구 국제금융로 10",
    lat: "37.5251775245928",
    lng: "126.924876706923"
}, {
    name: "스타벅스 합정폴리스R점",
    address: "서울 마포구 양화로 45",
    lat: "37.5515008030203",
    lng: "126.91395024016"
}, {
    name: "스타벅스 강남R점",
    address: "서울 강남구 강남대로 390",
    lat: "37.4978399531903",
    lng: "127.028578846319"
}, {
    name: "스타벅스 홍대입구역사거리R점",
    address: "서울 마포구 양화로 125",
    lat: "37.5547493986687",
    lng: "126.920309389675"
}, {
    name: "스타벅스 이대R점",
    address: "서울 서대문구 이화여대길 34",
    lat: "37.558453141276",
    lng: "126.945944197486"
}, {
    name: "스타벅스 강남대로논현R점",
    address: "서울 서초구 강남대로85길 5",
    lat: "37.507366411327",
    lng: "127.022594811887"
}, {
    name: "스타벅스 한남동R",
    address: "서울 용산구 독서당로 94",
    lat: "37.5348016217165",
    lng: "127.01093982785"
}, {
    name: "스타벅스 강남교보타워R점",
    address: "서울 서초구 강남대로 465 1층",
    lat: "37.5037560541254",
    lng: "127.024109539913"
}, {
    name: "스타벅스 한강진역R점",
    address: "서울 용산구 이태원로 252",
    lat: "37.5371098560042",
    lng: "127.001121839019"
}, {
    name: "스타벅스 양재강남빌딩R점",
    address: "서울 강남구 남부순환로 2621",
    lat: "37.4852524629892",
    lng: "127.036620943423"
}, {
    name: "스타벅스 광화문R점",
    address: "서울 종로구 세종대로 167 현대해상본사사옥 별관내",
    lat: "37.5712680054994",
    lng: "126.976304863447"
}, {
    name: "스타벅스 청담스타R점",
    address: "서울 강남구 도산대로57길 24",
    lat: "37.5252578873567",
    lng: "127.041837238386"
}, {
    name: "스타벅스 더종로R점",
    address: "서울 종로구 종로 51",
    lat: "37.5707451369668",
    lng: "126.983611410428"
}, {
    name: "스타벅스 압구정R점",
    address: "서울 강남구 언주로 861",
    lat: "37.5273990937168",
    lng: "127.033113547922"
}, {
    name: "스타벅스 마곡사이언스타워R점",
    address: "서울 강서구 마곡동로 62",
    lat: "37.5605537644679",
    lng: "126.833890184435"
}, {
    name: "스타벅스 선릉동신빌딩R점",
    address: "서울 강남구 테헤란로 409",
    lat: "37.5053601174069",
    lng: "127.050386949115"
}, {
    name: "스타벅스 대한상공회의소R점",
    address: "서울 중구 세종대로 39",
    lat: "37.5607136539523",
    lng: "126.973775321516"
}, {
    name: "스타벅스 스탈릿대치R점",
    address: "서울 강남구 남부순환로 2947 대원빌딩",
    lat: "37.4945700144534",
    lng: "127.062659097416"
}, {
    name: "스타벅스 수서역R점",
    address: "서울 강남구 광평로 281",
    lat: "37.4881167693611",
    lng: "127.103068802127"
}, {
    name: "스타벅스 SSG마켓도곡R점",
    address: "서울 강남구 언주로30길 57 타워팰리스 F동 지하1층",
    lat: "37.4894751267354",
    lng: "127.054005831296"
}, {
    name: "스타벅스 정부서울청사R점",
    address: "서울 종로구 새문안로5가길 28",
    lat: "37.574460196686",
    lng: "126.973597076089"
}, {
    name: "스타벅스 스타필드코엑스몰 R점",
    address: "서울 강남구 봉은사로 524",
    lat: "37.5129436953442",
    lng: "127.057114235894"
}, {
    name: "스타벅스 문정법원로R",
    address: "서울 송파구 송파대로 201",
    lat: "37.4877387829749",
    lng: "127.120685887596"
}, {
    name: "스타벅스 을지로내외빌딩R점",
    address: "서울 중구 을지로 51",
    lat: "37.5664928978912",
    lng: "126.983681840765"
}, {
    name: "스타벅스 잠실대교남단R점",
    address: "서울 송파구 송파대로 570 타워730 1층",
    lat: "37.5157873297768",
    lng: "127.099112358834"
}, {
    name: "스타벅스 삼성역섬유센터R점",
    address: "서울 강남구 테헤란로 518",
    lat: "37.5075910839105",
    lng: "127.060579419429"
}, {
    name: "스타벅스 판교아비뉴프랑R",
    address: "경기 성남시 분당구 동판교로177번길 25",
    lat: "37.3973207561987",
    lng: "127.11356226927"
}, {
    name: "스타벅스 백석R점",
    address: "경기 고양시 일산동구 중앙로 1059 1층",
    lat: "37.6439252083568",
    lng: "126.786163460774"
}, {
    name: "스타벅스 광교엘포트R점",
    address: "경기 수원시 영통구 광교중앙로 145",
    lat: "37.2870876096225",
    lng: "127.057781422092"
}, {
    name: "스타벅스 용인죽전역R점",
    address: "경기 용인시 수지구 용구대로 2750",
    lat: "37.3312486466949",
    lng: "127.109477369629"
}, {
    name: "스타벅스 송도트리플R점",
    address: "인천 연수구 송도과학로16번길 33-1",
    lat: "37.3810817742169",
    lng: "126.659461548975"
}, {
    name: "스타벅스 일산가로수길R점",
    address: "경기 고양시 일산서구 주엽로 80 E동 107호",
    lat: "37.6660625103382",
    lng: "126.756435827812"
}, {
    name: "스타벅스 영통R점",
    address: "경기 수원시 영통구 덕영대로 1566",
    lat: "37.2451294220493",
    lng: "127.061898704684"
}, {
    name: "스타벅스 스타필드고양1F R점",
    address: "경기 고양시 덕양구 고양대로 1955",
    lat: "37.6469771187284",
    lng: "126.89477806511"
}, {
    name: "스타벅스 동탄카림R점",
    address: "경기 화성시 동탄대로시범길 134",
    lat: "37.1990621454731",
    lng: "127.113228102981"
}, {
    name: "스타벅스 기흥역AK R점",
    address: "경기 용인시 기흥구 구갈동 227-26 기흥역 힐스테이트",
    lat: "37.2748064455919",
    lng: "127.117072065663"
}, {
    name: "스타벅스 용인에버랜드R점",
    address: "경기 용인시 처인구 포곡읍 에버랜드로 199",
    lat: "37.294066695953",
    lng: "127.202128029885"
}, {
    name: "스타벅스 천안신부R점",
    address: "충남 천안시 동남구 만남로 43 신세계충청점 본관3동 2층",
    lat: "36.8193302097389",
    lng: "127.15784651678"
}, {
    name: "스타벅스 스타필드안성R",
    address: "경기 안성시 공도읍 서동대로 3930-39 1층",
    lat: "36.9946334108693",
    lng: "127.147249620616"
}, {
    name: "스타벅스 춘천구봉산R",
    address: "강원 춘천시 동면 순환대로 1154-63",
    lat: "37.888407644804",
    lng: "127.775966121973"
}, {
    name: "스타벅스 세종어진R점",
    address: "세종특별자치시 한누리대로 499",
    lat: "36.50807108248",
    lng: "127.261120737985"
}, {
    name: "스타벅스 대전중앙로R점",
    address: "대전 중구 대종로 486",
    lat: "36.3279505649477",
    lng: "127.426592183659"
}, {
    name: "스타벅스 대구수성호수R점",
    address: "대구 수성구 용학로 56",
    lat: "35.8261024042922",
    lng: "128.615826603796"
}, {
    name: "스타벅스 대구그랜드호텔R점",
    address: "대구 수성구 동대구로 305",
    lat: "35.8576761508537",
    lng: "128.624984706372"
}, {
    name: "스타벅스 신세계대구8F R점",
    address: "대구 동구 동부로 149 신세계백화점 대구점 8층",
    lat: "35.8779406718693",
    lng: "128.629190024219"
}, {
    name: "스타벅스 창원상남동R점",
    address: "경남 창원시 성산구 상남로 132",
    lat: "35.2244707730609",
    lng: "128.683951898443"
}, {
    name: "스타벅스 서면로R점",
    address: "부산 부산진구 서면로 49-1",
    lat: "35.1552474300523",
    lng: "129.057532370274"
}, {
    name: "스타벅스 더해운대R점",
    address: "부산 해운대구 해운대해변로 197 해운대경동제이드아파트 101동",
    lat: "35.158802549379",
    lng: "129.152836637292"
}, {
    name: "스타벅스 서면중앙대로R점",
    address: "부산 부산진구 중앙대로 672",
    lat: "35.153006221653",
    lng: "129.059606320437"
}, {
    name: "스타벅스 부산덕천역R점",
    address: "부산 북구 만덕대로 30",
    lat: "35.2106613817795",
    lng: "129.00848016307"
}, {
    name: "스타벅스 부산광복로R점",
    address: "부산 중구 광복중앙로 8-2",
    lat: "35.1001081888799",
    lng: "129.03138410594"
}, {
    name: "스타벅스 신세계김해R점",
    address: "경남 김해시 김해대로 2232 신세계백화점 1층",
    lat: "35.2293396295983",
    lng: "128.872242572055"
}, {
    name: "스타벅스 제주신화월드R점",
    address: "제주특별자치도 서귀포시 안덕면 신화역사로304번길 38 지하1층 29호",
    lat: "33.3049726791712",
    lng: "126.31635202613"
}]




const geocoder = new kakao.maps.services.Geocoder();
const imageSrc = 'https://image.istarbucks.co.kr/common/img/store/pin/pin_reserve.png';
const imageSize = new kakao.maps.Size(38, 60);
const imageOption = {
    offset: new kakao.maps.Point(27, 69)
};
const markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption);


//가장 가까운 매장 이름 출력
const closeStore = document.querySelector('.show-closeStore');



function makeMap(myLat, myLng) {


    // 내위치 지도에 마커표시!!!!!!

    const container = document.getElementById('map');
    const options = {
        center: new kakao.maps.LatLng(myLat, myLng),
        level: 6,
        // scrollwheel: false
    };

    const map = new kakao.maps.Map(container, options);
    // 마커가 표시될 위치입니다 
    const myPosition = new kakao.maps.LatLng(myLat, myLng);


    // 마커를 생성합니다
    const marker = new kakao.maps.Marker({
        position: myPosition,
        title: '현재 내 위치!'
    });

    // 마커가 지도 위에 표시되도록 설정합니다
    marker.setMap(map);
    // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
    map.setCenter(myPosition);


    // data 안에 위도,경도 값이 담겨져있다면 주소값으로 위치를 찾지 않아도 바로 찾을 수 있음
    ////////////// json 데이터에 담긴 데이터의 주소값으로 위도경도 값을 따 지도에 표시!!
    let newData = [];
    for (let i = 0; i < data.length; i++) {

        geocoder.addressSearch(data[i].address, function (result, status) {
            // 정상적으로 검색이 완료됐으면 
            if (status === kakao.maps.services.Status.OK) {
                const storeLat = result[0].y;
                const storeLng = result[0].x;
                // console.log(`주소 : ${data[i].address}\n위도 : ${storeLat}\n경도 : ${storeLng} `);
                let newObj = new Object();
                newObj['name'] = data[i].name;
                newObj['address'] = data[i].address;
                newObj['lat'] = storeLat;
                newObj['lng'] = storeLng;
                newData.push(newObj);
            }
        });
    }
    //console 창에서 기존에 지점명과 주소만 담긴 data에 lat,lng값을 추가한 newData의 값을 출력
    // 여기서는 console창의 값을 복사하여 json값으로 바꿔 상단의 배열에 선언
    console.log('newData : ', newData);


    for (let i = 0; i < data.length; i++) {
        const coords = new kakao.maps.LatLng(data[i].lat, data[i].lng);

        // 결과값으로 받은 위치를 마커로 표시합니다
        const marker = new kakao.maps.Marker({
            map: map,
            position: coords,
            image: markerImage,
            title: `${data[i].address}\n${data[i].name}` //마우스를 마커에올리면 지점명 표시
        });
        marker.setMap(map);



        const content =
            '<div class="wrap">' +
            '    <div class="info">' +
            '        <div class="title">' +
            `               ${data[i].name}` +
            '        </div>' +
            '        <div class="body">' +
            '            <div class="img">' +
            '   <img src="https://image.istarbucks.co.kr/common/img/store/store_icon/icon01.png" alt="small_icon">' +
            '    <img src="https://image.istarbucks.co.kr/upload/common/img/icon/icon23.png" alt="wondo">' +
            '     <img src="https://image.istarbucks.co.kr/common/img/store/store_icon/icon10.png" alt="building">' +
            '           </div>' +
            '            <div class="desc">' +
            '               <div class="ellipsis">' +
            '    <img src="https://www.starbucks.co.kr/common/img/store/icon_addr.png" alt="addr-icon">' +
            `                    ${data[i].address}</div>` +
            '               <div class="ellipsis">' +
            '    <img src="https://www.starbucks.co.kr/common/img/store/icon_tel.png" alt="tel-icon">' +
            '                    1522-3232</div>' +
            '                <div><a href="https://www.starbucks.co.kr/store/store_map.do" target="_blank" class="link">길 찾기</a></div>' +
            '            </div>' +
            '        </div>' +
            '    </div>' +
            '</div>';


        // 마커 위에 커스텀오버레이를 표시합니다
        // 마커를 중심으로 커스텀 오버레이를 표시하기위해 CSS를 이용해 위치를 설정했습니다
        let overlay = new kakao.maps.CustomOverlay({
            content: content,
            map: map,
            position: marker.getPosition()
        });
        overlay.setMap(null);


        // 마커를 클릭했을 때 커스텀 오버레이를 표시합니다 / 다시누르면 사라짐
        kakao.maps.event.addListener(marker, 'click', function () {
            if (overlay.getMap() === null) {
                overlay.setMap(map);
            } else {
                overlay.setMap(null);
            }
        });
    }



    ////////////// 사용자의 위치 기반으로 가장 가까운 매장 순으로 나열!
    sortCloseStore(myLat, myLng);


}


function sortCloseStore(myLat, myLng) {
    for (let i = 0; i < data.length; i++) {
        let distance = getDistance(myLat, myLng, data[i].lat, data[i].lng, "K");
        data[i].distance = distance;
    }

    //정렬된 데이터
    // value 기준으로 정렬
    let sortedData = data.sort(function (a, b) {
        if (a.distance > b.distance) {
            return 1;
        }
        if (a.distance < b.distance) {
            return -1;
        }
        return 0;
    });

    const closestStore = sortedData[0];

    //소수점 버리기
    const km = Math.floor(closestStore.distance);

    closeStore.innerText = `${closestStore.name}!! \n 
                            ${closestStore.address}에 위치해요! \n
                            현재 위치에서 약 ${km}km 만큼 떨어져 있어요!`;
    console.log("정렬된 데이터 : ", sortedData);
}


//unit의 값을 k로 넣으면 km 단위로 값을 매겨줌
function getDistance(lat1, lon1, lat2, lon2, unit) {
    var radlat1 = Math.PI * lat1 / 180
    var radlat2 = Math.PI * lat2 / 180
    var radlon1 = Math.PI * lon1 / 180
    var radlon2 = Math.PI * lon2 / 180
    var theta = lon1 - lon2
    var radtheta = Math.PI * theta / 180
    var dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);
    dist = Math.acos(dist)
    dist = dist * 180 / Math.PI
    dist = dist * 60 * 1.1515
    if (unit == "K") {
        dist = dist * 1.609344
    }
    if (unit == "N") {
        dist = dist * 0.8684
    }
    return dist
}



function handleGeoSuccess(position) {
    console.log(position);

    const latitude = position.coords.latitude;
    const longitude = position.coords.longitude;

    makeMap(latitude, longitude);
}

function handleGeoError() {
    console.log('cannot access geo location');
}


function askLocation() {
    navigator.geolocation.getCurrentPosition(handleGeoSuccess, handleGeoError);
}


function init() {
    askLocation();
}

init();
